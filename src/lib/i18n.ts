import { readFileSync, existsSync } from 'fs';

type Translations = Record<string, Record<string, string>>;

const translations: Translations = {
  en_US: {
    'cli.title': 'MiniMax M2.1 Coding Helper',
    'cli.examples': 'Examples',
    'commands.init': 'Run setup wizard',
    'commands.doctor': 'Check configuration',
    'commands.version': 'Show version',
    'commands.help': 'Show help',
    'lang.current': 'Current language',
    'lang.set_success': 'Language set to',
    'messages.first_run': 'Welcome! Let\'s configure MiniMax M2.1.',
    'messages.select_lang': 'Select language',
    'messages.select_region': 'Select region',
    'messages.enter_api_key': 'Enter MiniMax API key',
    'messages.select_tool': 'Select tool to configure',
    'messages.config_success': 'configured successfully!',
    'messages.api_key_saved': 'API key saved',
    'messages.api_key_revoked': 'API key revoked',
    'messages.no_api_key': 'No API key. Run: mhelper init',
    'messages.current': 'Current',
    'messages.not_set': 'Not set',
    'messages.uninstalled': 'configuration removed',
    'messages.no_configs': 'No tools configured',
    'messages.all_uninstalled': 'All configurations removed',
    'doctor.checking': 'Checking configuration...',
    'doctor.api_key': 'API Key',
    'doctor.region': 'Region',
    'doctor.lang': 'Language',
    'doctor.configured': 'Configured',
    'doctor.not_configured': 'Not configured',
    'doctor.tools_status': 'Configured tools',
    'wizard.main_menu': 'What would you like to do?',
    'wizard.config_lang': 'Change language',
    'wizard.config_region': 'Change region',
    'wizard.config_api_key': 'Change API key',
    'wizard.config_tool': 'Configure coding tool',
    'wizard.config_mcp': 'Configure MCP server',
    'wizard.uninstall': 'Remove configuration',
    'wizard.doctor': 'Health check',
    'wizard.exit': 'Exit',
    'wizard.configure_now': 'Configure a tool now?',
    'wizard.install_config': 'Install/Configure',
    'wizard.remove_config': 'Remove configuration',
    'wizard.select_mcp': 'Select MCP target',
    'wizard.mcp_info': 'Show MCP config info',
    'wizard.select_uninstall': 'Select tool to remove',
    'wizard.uninstall_all': 'Remove ALL configurations',
    'wizard.confirm_uninstall_all': 'Remove all MiniMax configurations?',
  },
  es_ES: {
    'cli.title': 'MiniMax M2.1 Coding Helper',
    'cli.examples': 'Ejemplos',
    'commands.init': 'Ejecutar asistente',
    'commands.doctor': 'Verificar configuración',
    'commands.version': 'Mostrar versión',
    'commands.help': 'Mostrar ayuda',
    'lang.current': 'Idioma actual',
    'lang.set_success': 'Idioma establecido a',
    'messages.first_run': '¡Bienvenido! Configuremos MiniMax M2.1.',
    'messages.select_lang': 'Selecciona idioma',
    'messages.select_region': 'Selecciona región',
    'messages.enter_api_key': 'Ingresa tu API key de MiniMax',
    'messages.select_tool': 'Selecciona herramienta',
    'messages.config_success': '¡configurado exitosamente!',
    'messages.api_key_saved': 'API key guardada',
    'messages.api_key_revoked': 'API key revocada',
    'messages.no_api_key': 'Sin API key. Ejecuta: mhelper init',
    'messages.current': 'Actual',
    'messages.not_set': 'No configurado',
    'messages.uninstalled': 'configuración eliminada',
    'messages.no_configs': 'Sin herramientas configuradas',
    'messages.all_uninstalled': 'Todas las configuraciones eliminadas',
    'doctor.checking': 'Verificando configuración...',
    'doctor.api_key': 'API Key',
    'doctor.region': 'Región',
    'doctor.lang': 'Idioma',
    'doctor.configured': 'Configurado',
    'doctor.not_configured': 'No configurado',
    'doctor.tools_status': 'Herramientas configuradas',
    'wizard.main_menu': '¿Qué deseas hacer?',
    'wizard.config_lang': 'Cambiar idioma',
    'wizard.config_region': 'Cambiar región',
    'wizard.config_api_key': 'Cambiar API key',
    'wizard.config_tool': 'Configurar herramienta',
    'wizard.config_mcp': 'Configurar servidor MCP',
    'wizard.uninstall': 'Eliminar configuración',
    'wizard.doctor': 'Verificar estado',
    'wizard.exit': 'Salir',
    'wizard.configure_now': '¿Configurar una herramienta ahora?',
    'wizard.install_config': 'Instalar/Configurar',
    'wizard.remove_config': 'Eliminar configuración',
    'wizard.select_mcp': 'Seleccionar destino MCP',
    'wizard.mcp_info': 'Mostrar info de config MCP',
    'wizard.select_uninstall': 'Seleccionar herramienta a eliminar',
    'wizard.uninstall_all': 'Eliminar TODAS las configuraciones',
    'wizard.confirm_uninstall_all': '¿Eliminar todas las configuraciones de MiniMax?',
  },
  zh_CN: {
    'cli.title': 'MiniMax M2.1 编程助手',
    'cli.examples': '示例',
    'commands.init': '运行设置向导',
    'commands.doctor': '检查配置',
    'commands.version': '显示版本',
    'commands.help': '显示帮助',
    'lang.current': '当前语言',
    'lang.set_success': '语言已设置为',
    'messages.first_run': '欢迎！让我们配置MiniMax M2.1。',
    'messages.select_lang': '选择语言',
    'messages.select_region': '选择区域',
    'messages.enter_api_key': '输入MiniMax API密钥',
    'messages.select_tool': '选择要配置的工具',
    'messages.config_success': '配置成功！',
    'messages.api_key_saved': 'API密钥已保存',
    'messages.api_key_revoked': 'API密钥已撤销',
    'messages.no_api_key': '无API密钥。运行: mhelper init',
    'messages.current': '当前',
    'messages.not_set': '未设置',
    'messages.uninstalled': '配置已删除',
    'messages.no_configs': '没有配置的工具',
    'messages.all_uninstalled': '所有配置已删除',
    'doctor.checking': '正在检查配置...',
    'doctor.api_key': 'API密钥',
    'doctor.region': '区域',
    'doctor.lang': '语言',
    'doctor.configured': '已配置',
    'doctor.not_configured': '未配置',
    'doctor.tools_status': '已配置的工具',
    'wizard.main_menu': '您想做什么？',
    'wizard.config_lang': '更改语言',
    'wizard.config_region': '更改区域',
    'wizard.config_api_key': '更改API密钥',
    'wizard.config_tool': '配置编程工具',
    'wizard.config_mcp': '配置MCP服务器',
    'wizard.uninstall': '删除配置',
    'wizard.doctor': '健康检查',
    'wizard.exit': '退出',
    'wizard.configure_now': '现在配置工具？',
    'wizard.install_config': '安装/配置',
    'wizard.remove_config': '删除配置',
    'wizard.select_mcp': '选择MCP目标',
    'wizard.mcp_info': '显示MCP配置信息',
    'wizard.select_uninstall': '选择要删除的工具',
    'wizard.uninstall_all': '删除所有配置',
    'wizard.confirm_uninstall_all': '删除所有MiniMax配置？',
  }
};

class I18n {
  private locale: string = 'en_US';

  loadFromConfig(lang: string): void {
    this.locale = translations[lang] ? lang : 'en_US';
  }

  t(key: string): string {
    return translations[this.locale]?.[key] || translations['en_US']?.[key] || key;
  }

  getLocale(): string { return this.locale; }
}

export const i18n = new I18n();
